# not_malware (rev)

We are given a binary and a server to `nc` to. Let's inspect the binary first. If we run it, we are prompted to enter some input:
```
$ ./not_malware
What's your credit card number (for safekeeping) ?
>> 
```
But interestingly, if we run it within `gdb`, it exits with an error immediately.
```
(gdb) r
Starting program: not_malware 
[Inferior 1 (process 8444) exited with code 01]
```
Running it under `strace` does the same as well:
```
$ strace ./not_malware
execve("./not_malware", ["./not_malware"], 0x7ffe9d77ae10 /* 33 vars */) = 0
brk(NULL)                               = 0x562398688000
arch_prctl(0x3001 /* ARCH_??? */, 0x7fff51dc4d80) = -1 EINVAL (Invalid argument)
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
openat(AT_FDCWD, "/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=47012, ...}) = 0
mmap(NULL, 47012, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f6fbbebe000
close(3)                                = 0
openat(AT_FDCWD, "/lib/x86_64-linux-gnu/libm.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\300\363\0\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0644, st_size=1369352, ...}) = 0
mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f6fbbebc000
mmap(NULL, 1368336, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f6fbbd6d000
mmap(0x7f6fbbd7c000, 684032, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0xf000) = 0x7f6fbbd7c000
mmap(0x7f6fbbe23000, 618496, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0xb6000) = 0x7f6fbbe23000
mmap(0x7f6fbbeba000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x14c000) = 0x7f6fbbeba000
close(3)                                = 0
openat(AT_FDCWD, "/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\360q\2\0\0\0\0\0"..., 832) = 832
pread64(3, "\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0"..., 784, 64) = 784
pread64(3, "\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0", 32, 848) = 32
pread64(3, "\4\0\0\0\24\0\0\0\3\0\0\0GNU\0cBR\340\305\370\2609W\242\345)q\235A\1"..., 68, 880) = 68
fstat(3, {st_mode=S_IFREG|0755, st_size=2029224, ...}) = 0
pread64(3, "\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0"..., 784, 64) = 784
pread64(3, "\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0", 32, 848) = 32
pread64(3, "\4\0\0\0\24\0\0\0\3\0\0\0GNU\0cBR\340\305\370\2609W\242\345)q\235A\1"..., 68, 880) = 68
mmap(NULL, 2036952, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f6fbbb7b000
mprotect(0x7f6fbbba0000, 1847296, PROT_NONE) = 0
mmap(0x7f6fbbba0000, 1540096, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x25000) = 0x7f6fbbba0000
mmap(0x7f6fbbd18000, 303104, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x19d000) = 0x7f6fbbd18000
mmap(0x7f6fbbd63000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1e7000) = 0x7f6fbbd63000
mmap(0x7f6fbbd69000, 13528, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f6fbbd69000
close(3)                                = 0
mmap(NULL, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f6fbbb78000
arch_prctl(ARCH_SET_FS, 0x7f6fbbb78740) = 0
mprotect(0x7f6fbbd63000, 12288, PROT_READ) = 0
mprotect(0x7f6fbbeba000, 4096, PROT_READ) = 0
mprotect(0x562397e8c000, 4096, PROT_READ) = 0
mprotect(0x7f6fbbef7000, 4096, PROT_READ) = 0
munmap(0x7f6fbbebe000, 47012)           = 0
openat(AT_FDCWD, "/etc/ld.so.preload", O_RDONLY) = -1 ENOENT (No such file or directory)
ptrace(PTRACE_TRACEME)                  = -1 EPERM (Operation not permitted)
exit_group(1)                           = ?
+++ exited with 1 +++
```
It seems like this binary is smart enough to detect when it is being debugged and exit immediately. We can see from the `strace` output that it does a `ptrace` call to check if it is being traced. It also checks if we are using `/etc/ld.so.preload`.

Let's run `strings` on it.
```
$ strings not_malware
/lib64/ld-linux-x86-64.so.2
libm.so.6
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
libc.so.6
exit
srand
fopen
strncmp
puts
stdin
fgets
strlen
__isoc99_fscanf
fclose
getenv
ptrace
__cxa_finalize
__libc_start_main
snprintf
GLIBC_2.29
GLIBC_2.7
GLIBC_2.2.5
u3UH
[]A\A]A^A_
yeetbank
peepbank
heapbank
softbank
seatbank
zorpbank
flag.txt
What's your credit card number (for safekeeping) ?
Well this was unnecessary.
Get out.
Thanks!
?VMwareVMware
KVMKVMKVM
TCGTCGTCGTCG
Microsoft Hv
 lrpepyh vr
LD_PRELOAD
/etc/ld.so.preload
;*3$"
GCC: (Arch Linux 9.3.0-1) 9.3.0
GCC: (GNU) 10.1.0
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got
.got.plt
.data
.bss
.comment
```
From the strings such as `VMwareVMware` and `Microsoft Hv` we can infer that it even checks that you aren't running it in a VM. Well I guess the only way is to dump the assembly and figure out how it works by hand.

Disassembling gives us this:
```
Disassembly of section .text:

0000000000001130 <.text>:
    1130:	f3 0f 1e fa          	endbr64 
    1134:	31 ed                	xor    %ebp,%ebp
    1136:	49 89 d1             	mov    %rdx,%r9
    1139:	5e                   	pop    %rsi
    113a:	48 89 e2             	mov    %rsp,%rdx
    113d:	48 83 e4 f0          	and    $0xfffffffffffffff0,%rsp
    1141:	50                   	push   %rax
    1142:	54                   	push   %rsp
    1143:	4c 8d 05 16 08 00 00 	lea    0x816(%rip),%r8        # 1960 <rand@plt+0x840>
    114a:	48 8d 0d 9f 07 00 00 	lea    0x79f(%rip),%rcx        # 18f0 <rand@plt+0x7d0>
    1151:	48 8d 3d 64 01 00 00 	lea    0x164(%rip),%rdi        # 12bc <rand@plt+0x19c>
    1158:	ff 15 82 2e 00 00    	callq  *0x2e82(%rip)        # 3fe0 <rand@plt+0x2ec0>
    115e:	f4                   	hlt    
    115f:	90                   	nop
    1160:	48 8d 3d 41 2f 00 00 	lea    0x2f41(%rip),%rdi        # 40a8 <rand@plt+0x2f88>
    1167:	48 8d 05 3a 2f 00 00 	lea    0x2f3a(%rip),%rax        # 40a8 <rand@plt+0x2f88>
    116e:	48 39 f8             	cmp    %rdi,%rax
    1171:	74 15                	je     1188 <rand@plt+0x68>
    1173:	48 8b 05 5e 2e 00 00 	mov    0x2e5e(%rip),%rax        # 3fd8 <rand@plt+0x2eb8>
    117a:	48 85 c0             	test   %rax,%rax
    117d:	74 09                	je     1188 <rand@plt+0x68>
    117f:	ff e0                	jmpq   *%rax
    1181:	0f 1f 80 00 00 00 00 	nopl   0x0(%rax)
    1188:	c3                   	retq   
    1189:	0f 1f 80 00 00 00 00 	nopl   0x0(%rax)
    1190:	48 8d 3d 11 2f 00 00 	lea    0x2f11(%rip),%rdi        # 40a8 <rand@plt+0x2f88>
    1197:	48 8d 35 0a 2f 00 00 	lea    0x2f0a(%rip),%rsi        # 40a8 <rand@plt+0x2f88>
    119e:	48 29 fe             	sub    %rdi,%rsi
    11a1:	48 89 f0             	mov    %rsi,%rax
    11a4:	48 c1 ee 3f          	shr    $0x3f,%rsi
    11a8:	48 c1 f8 03          	sar    $0x3,%rax
    11ac:	48 01 c6             	add    %rax,%rsi
    11af:	48 d1 fe             	sar    %rsi
    11b2:	74 14                	je     11c8 <rand@plt+0xa8>
    11b4:	48 8b 05 35 2e 00 00 	mov    0x2e35(%rip),%rax        # 3ff0 <rand@plt+0x2ed0>
    11bb:	48 85 c0             	test   %rax,%rax
    11be:	74 08                	je     11c8 <rand@plt+0xa8>
    11c0:	ff e0                	jmpq   *%rax
    11c2:	66 0f 1f 44 00 00    	nopw   0x0(%rax,%rax,1)
    11c8:	c3                   	retq   
    11c9:	0f 1f 80 00 00 00 00 	nopl   0x0(%rax)
    11d0:	f3 0f 1e fa          	endbr64 
    11d4:	80 3d dd 2e 00 00 00 	cmpb   $0x0,0x2edd(%rip)        # 40b8 <stdin@@GLIBC_2.2.5+0x8>
    11db:	75 33                	jne    1210 <rand@plt+0xf0>
    11dd:	55                   	push   %rbp
    11de:	48 83 3d 12 2e 00 00 	cmpq   $0x0,0x2e12(%rip)        # 3ff8 <rand@plt+0x2ed8>
    11e5:	00 
    11e6:	48 89 e5             	mov    %rsp,%rbp
    11e9:	74 0d                	je     11f8 <rand@plt+0xd8>
    11eb:	48 8b 3d ae 2e 00 00 	mov    0x2eae(%rip),%rdi        # 40a0 <rand@plt+0x2f80>
    11f2:	ff 15 00 2e 00 00    	callq  *0x2e00(%rip)        # 3ff8 <rand@plt+0x2ed8>
    11f8:	e8 63 ff ff ff       	callq  1160 <rand@plt+0x40>
    11fd:	c6 05 b4 2e 00 00 01 	movb   $0x1,0x2eb4(%rip)        # 40b8 <stdin@@GLIBC_2.2.5+0x8>
    1204:	5d                   	pop    %rbp
    1205:	c3                   	retq   
    1206:	66 2e 0f 1f 84 00 00 	nopw   %cs:0x0(%rax,%rax,1)
    120d:	00 00 00 
    1210:	c3                   	retq   
    1211:	66 66 2e 0f 1f 84 00 	data16 nopw %cs:0x0(%rax,%rax,1)
    1218:	00 00 00 00 
    121c:	0f 1f 40 00          	nopl   0x0(%rax)
    1220:	f3 0f 1e fa          	endbr64 
    1224:	e9 67 ff ff ff       	jmpq   1190 <rand@plt+0x70>
    1229:	55                   	push   %rbp
    122a:	48 89 e5             	mov    %rsp,%rbp
    122d:	48 81 ec 10 01 00 00 	sub    $0x110,%rsp
    1234:	48 8d 35 1b 0e 00 00 	lea    0xe1b(%rip),%rsi        # 2056 <rand@plt+0xf36>
    123b:	48 8d 3d 16 0e 00 00 	lea    0xe16(%rip),%rdi        # 2058 <rand@plt+0xf38>
    1242:	e8 b9 fe ff ff       	callq  1100 <fopen@plt>
    1247:	48 89 45 f8          	mov    %rax,-0x8(%rbp)
    124b:	48 8d 95 f0 fe ff ff 	lea    -0x110(%rbp),%rdx
    1252:	48 8b 45 f8          	mov    -0x8(%rbp),%rax
    1256:	48 8d 35 04 0e 00 00 	lea    0xe04(%rip),%rsi        # 2061 <rand@plt+0xf41>
    125d:	48 89 c7             	mov    %rax,%rdi
    1260:	b8 00 00 00 00       	mov    $0x0,%eax
    1265:	e8 e6 fd ff ff       	callq  1050 <__isoc99_fscanf@plt>
    126a:	48 8d 85 f0 fe ff ff 	lea    -0x110(%rbp),%rax
    1271:	48 89 c7             	mov    %rax,%rdi
    1274:	e8 e7 fd ff ff       	callq  1060 <puts@plt>
    1279:	48 8b 45 f8          	mov    -0x8(%rbp),%rax
    127d:	48 89 c7             	mov    %rax,%rdi
    1280:	e8 fb fd ff ff       	callq  1080 <fclose@plt>
    1285:	90                   	nop
    1286:	c9                   	leaveq 
    1287:	c3                   	retq   
    1288:	55                   	push   %rbp
    1289:	48 89 e5             	mov    %rsp,%rbp
    128c:	48 83 ec 10          	sub    $0x10,%rsp
    1290:	89 7d fc             	mov    %edi,-0x4(%rbp)
    1293:	8b 45 fc             	mov    -0x4(%rbp),%eax
    1296:	89 c7                	mov    %eax,%edi
    1298:	e8 23 fe ff ff       	callq  10c0 <srand@plt>
    129d:	e8 7e fe ff ff       	callq  1120 <rand@plt>
    12a2:	48 98                	cltq   
    12a4:	c9                   	leaveq 
    12a5:	c3                   	retq   
    12a6:	55                   	push   %rbp
    12a7:	48 89 e5             	mov    %rsp,%rbp
    12aa:	e8 d3 04 00 00       	callq  1782 <rand@plt+0x662>
    12af:	e8 ba 05 00 00       	callq  186e <rand@plt+0x74e>
    12b4:	e8 fb 05 00 00       	callq  18b4 <rand@plt+0x794>
    12b9:	90                   	nop
    12ba:	5d                   	pop    %rbp
    12bb:	c3                   	retq   
    12bc:	55                   	push   %rbp
    12bd:	48 89 e5             	mov    %rsp,%rbp
    12c0:	48 81 ec b0 00 00 00 	sub    $0xb0,%rsp
    12c7:	e8 da ff ff ff       	callq  12a6 <rand@plt+0x186>
    12cc:	48 8d 3d 95 0d 00 00 	lea    0xd95(%rip),%rdi        # 2068 <rand@plt+0xf48>
    12d3:	b8 00 00 00 00       	mov    $0x0,%eax
    12d8:	e8 c3 fd ff ff       	callq  10a0 <printf@plt>
    12dd:	48 8b 15 cc 2d 00 00 	mov    0x2dcc(%rip),%rdx        # 40b0 <stdin@@GLIBC_2.2.5>
    12e4:	48 8d 45 a0          	lea    -0x60(%rbp),%rax
    12e8:	be 3c 00 00 00       	mov    $0x3c,%esi
    12ed:	48 89 c7             	mov    %rax,%rdi
    12f0:	e8 db fd ff ff       	callq  10d0 <fgets@plt>
    12f5:	48 8d 45 a0          	lea    -0x60(%rbp),%rax
    12f9:	48 89 c7             	mov    %rax,%rdi
    12fc:	e8 8f fd ff ff       	callq  1090 <strlen@plt>
    1301:	48 83 f8 3c          	cmp    $0x3c,%rax
    1305:	76 16                	jbe    131d <rand@plt+0x1fd>
    1307:	48 8d 3d 91 0d 00 00 	lea    0xd91(%rip),%rdi        # 209f <rand@plt+0xf7f>
    130e:	e8 4d fd ff ff       	callq  1060 <puts@plt>
    1313:	bf 01 00 00 00       	mov    $0x1,%edi
    1318:	e8 f3 fd ff ff       	callq  1110 <exit@plt>
    131d:	c7 45 f0 00 00 00 00 	movl   $0x0,-0x10(%rbp)
    1324:	81 45 f0 00 01 00 00 	addl   $0x100,-0x10(%rbp)
    132b:	c1 7d f0 04          	sarl   $0x4,-0x10(%rbp)
    132f:	66 0f ef d2          	pxor   %xmm2,%xmm2
    1333:	f2 0f 2a 55 f0       	cvtsi2sdl -0x10(%rbp),%xmm2
    1338:	66 48 0f 7e d0       	movq   %xmm2,%rax
    133d:	f2 0f 10 05 8b 0d 00 	movsd  0xd8b(%rip),%xmm0        # 20d0 <rand@plt+0xfb0>
    1344:	00 
    1345:	66 0f 28 c8          	movapd %xmm0,%xmm1
    1349:	66 48 0f 6e c0       	movq   %rax,%xmm0
    134e:	e8 1d fd ff ff       	callq  1070 <pow@plt>
    1353:	66 48 0f 7e c0       	movq   %xmm0,%rax
    1358:	f2 0f 10 05 78 0d 00 	movsd  0xd78(%rip),%xmm0        # 20d8 <rand@plt+0xfb8>
    135f:	00 
    1360:	66 48 0f 6e c8       	movq   %rax,%xmm1
    1365:	f2 0f 5c c8          	subsd  %xmm0,%xmm1
    1369:	f2 0f 2c c1          	cvttsd2si %xmm1,%eax
    136d:	89 45 f0             	mov    %eax,-0x10(%rbp)
    1370:	c7 45 fc 00 00 00 00 	movl   $0x0,-0x4(%rbp)
    1377:	eb 17                	jmp    1390 <rand@plt+0x270>
    1379:	8b 45 fc             	mov    -0x4(%rbp),%eax
    137c:	48 98                	cltq   
    137e:	0f b6 54 05 a0       	movzbl -0x60(%rbp,%rax,1),%edx
    1383:	8b 45 fc             	mov    -0x4(%rbp),%eax
    1386:	48 98                	cltq   
    1388:	88 54 05 e0          	mov    %dl,-0x20(%rbp,%rax,1)
    138c:	83 45 fc 01          	addl   $0x1,-0x4(%rbp)
    1390:	83 7d fc 07          	cmpl   $0x7,-0x4(%rbp)
    1394:	7e e3                	jle    1379 <rand@plt+0x259>
    1396:	8b 45 fc             	mov    -0x4(%rbp),%eax
    1399:	48 98                	cltq   
    139b:	c6 44 05 e0 00       	movb   $0x0,-0x20(%rbp,%rax,1)
    13a0:	8b 45 f0             	mov    -0x10(%rbp),%eax
    13a3:	48 63 d0             	movslq %eax,%rdx
    13a6:	48 89 d0             	mov    %rdx,%rax
    13a9:	48 c1 e0 03          	shl    $0x3,%rax
    13ad:	48 01 c2             	add    %rax,%rdx
    13b0:	48 8d 05 69 0c 00 00 	lea    0xc69(%rip),%rax        # 2020 <rand@plt+0xf00>
    13b7:	48 8d 0c 02          	lea    (%rdx,%rax,1),%rcx
    13bb:	48 8d 45 e0          	lea    -0x20(%rbp),%rax
    13bf:	ba 08 00 00 00       	mov    $0x8,%edx
    13c4:	48 89 ce             	mov    %rcx,%rsi
    13c7:	48 89 c7             	mov    %rax,%rdi
    13ca:	e8 71 fc ff ff       	callq  1040 <strncmp@plt>
    13cf:	85 c0                	test   %eax,%eax
    13d1:	74 0a                	je     13dd <rand@plt+0x2bd>
    13d3:	bf 01 00 00 00       	mov    $0x1,%edi
    13d8:	e8 33 fd ff ff       	callq  1110 <exit@plt>
    13dd:	0f b6 45 a8          	movzbl -0x58(%rbp),%eax
    13e1:	3c 3a                	cmp    $0x3a,%al
    13e3:	74 16                	je     13fb <rand@plt+0x2db>
    13e5:	48 8d 3d ce 0c 00 00 	lea    0xcce(%rip),%rdi        # 20ba <rand@plt+0xf9a>
    13ec:	e8 6f fc ff ff       	callq  1060 <puts@plt>
    13f1:	bf 01 00 00 00       	mov    $0x1,%edi
    13f6:	e8 15 fd ff ff       	callq  1110 <exit@plt>
    13fb:	0f b6 45 a9          	movzbl -0x57(%rbp),%eax
    13ff:	0f be c0             	movsbl %al,%eax
    1402:	83 e8 30             	sub    $0x30,%eax
    1405:	89 45 f8             	mov    %eax,-0x8(%rbp)
    1408:	0f b6 45 aa          	movzbl -0x56(%rbp),%eax
    140c:	0f be c0             	movsbl %al,%eax
    140f:	83 e8 30             	sub    $0x30,%eax
    1412:	89 45 ec             	mov    %eax,-0x14(%rbp)
    1415:	0f b6 45 ab          	movzbl -0x55(%rbp),%eax
    1419:	0f be c0             	movsbl %al,%eax
    141c:	83 e8 30             	sub    $0x30,%eax
    141f:	89 45 e8             	mov    %eax,-0x18(%rbp)
    1422:	0f b6 45 ac          	movzbl -0x54(%rbp),%eax
    1426:	3c 3a                	cmp    $0x3a,%al
    1428:	74 16                	je     1440 <rand@plt+0x320>
    142a:	48 8d 3d 89 0c 00 00 	lea    0xc89(%rip),%rdi        # 20ba <rand@plt+0xf9a>
    1431:	e8 2a fc ff ff       	callq  1060 <puts@plt>
    1436:	bf 01 00 00 00       	mov    $0x1,%edi
    143b:	e8 d0 fc ff ff       	callq  1110 <exit@plt>
    1440:	c7 45 f4 00 00 00 00 	movl   $0x0,-0xc(%rbp)
    1447:	eb 50                	jmp    1499 <rand@plt+0x379>
    1449:	8b 45 f8             	mov    -0x8(%rbp),%eax
    144c:	89 c7                	mov    %eax,%edi
    144e:	e8 35 fe ff ff       	callq  1288 <rand@plt+0x168>
    1453:	48 89 c2             	mov    %rax,%rdx
    1456:	48 8d 85 52 ff ff ff 	lea    -0xae(%rbp),%rax
    145d:	48 89 d1             	mov    %rdx,%rcx
    1460:	48 8d 15 5c 0c 00 00 	lea    0xc5c(%rip),%rdx        # 20c3 <rand@plt+0xfa3>
    1467:	be 0a 00 00 00       	mov    $0xa,%esi
    146c:	48 89 c7             	mov    %rax,%rdi
    146f:	b8 00 00 00 00       	mov    $0x0,%eax
    1474:	e8 37 fc ff ff       	callq  10b0 <snprintf@plt>
    1479:	8b 45 e8             	mov    -0x18(%rbp),%eax
    147c:	48 98                	cltq   
    147e:	0f b6 94 05 52 ff ff 	movzbl -0xae(%rbp,%rax,1),%edx
    1485:	ff 
    1486:	8b 45 f4             	mov    -0xc(%rbp),%eax
    1489:	48 98                	cltq   
    148b:	88 54 05 80          	mov    %dl,-0x80(%rbp,%rax,1)
    148f:	8b 45 ec             	mov    -0x14(%rbp),%eax
    1492:	01 45 f8             	add    %eax,-0x8(%rbp)
    1495:	83 45 f4 01          	addl   $0x1,-0xc(%rbp)
    1499:	83 7d f4 13          	cmpl   $0x13,-0xc(%rbp)
    149d:	7e aa                	jle    1449 <rand@plt+0x329>
    149f:	c7 45 fc 00 00 00 00 	movl   $0x0,-0x4(%rbp)
    14a6:	eb 1d                	jmp    14c5 <rand@plt+0x3a5>
    14a8:	8b 45 fc             	mov    -0x4(%rbp),%eax
    14ab:	83 c0 0d             	add    $0xd,%eax
    14ae:	48 98                	cltq   
    14b0:	0f b6 54 05 a0       	movzbl -0x60(%rbp,%rax,1),%edx
    14b5:	8b 45 fc             	mov    -0x4(%rbp),%eax
    14b8:	48 98                	cltq   
    14ba:	88 94 05 60 ff ff ff 	mov    %dl,-0xa0(%rbp,%rax,1)
    14c1:	83 45 fc 01          	addl   $0x1,-0x4(%rbp)
    14c5:	83 7d fc 13          	cmpl   $0x13,-0x4(%rbp)
    14c9:	7e dd                	jle    14a8 <rand@plt+0x388>
    14cb:	0f b6 95 60 ff ff ff 	movzbl -0xa0(%rbp),%edx
    14d2:	0f b6 45 80          	movzbl -0x80(%rbp),%eax
    14d6:	38 c2                	cmp    %al,%dl
    14d8:	74 0a                	je     14e4 <rand@plt+0x3c4>
    14da:	bf 01 00 00 00       	mov    $0x1,%edi
    14df:	e8 2c fc ff ff       	callq  1110 <exit@plt>
    14e4:	0f b6 95 70 ff ff ff 	movzbl -0x90(%rbp),%edx
    14eb:	0f b6 45 90          	movzbl -0x70(%rbp),%eax
    14ef:	38 c2                	cmp    %al,%dl
    14f1:	74 0a                	je     14fd <rand@plt+0x3dd>
    14f3:	bf 01 00 00 00       	mov    $0x1,%edi
    14f8:	e8 13 fc ff ff       	callq  1110 <exit@plt>
    14fd:	0f b6 95 6b ff ff ff 	movzbl -0x95(%rbp),%edx
    1504:	0f b6 45 8b          	movzbl -0x75(%rbp),%eax
    1508:	38 c2                	cmp    %al,%dl
    150a:	74 0a                	je     1516 <rand@plt+0x3f6>
    150c:	bf 01 00 00 00       	mov    $0x1,%edi
    1511:	e8 fa fb ff ff       	callq  1110 <exit@plt>
    1516:	0f b6 95 63 ff ff ff 	movzbl -0x9d(%rbp),%edx
    151d:	0f b6 45 83          	movzbl -0x7d(%rbp),%eax
    1521:	38 c2                	cmp    %al,%dl
    1523:	74 0a                	je     152f <rand@plt+0x40f>
    1525:	bf 01 00 00 00       	mov    $0x1,%edi
    152a:	e8 e1 fb ff ff       	callq  1110 <exit@plt>
    152f:	0f b6 95 67 ff ff ff 	movzbl -0x99(%rbp),%edx
    1536:	0f b6 45 87          	movzbl -0x79(%rbp),%eax
    153a:	38 c2                	cmp    %al,%dl
    153c:	74 0a                	je     1548 <rand@plt+0x428>
    153e:	bf 01 00 00 00       	mov    $0x1,%edi
    1543:	e8 c8 fb ff ff       	callq  1110 <exit@plt>
    1548:	0f b6 95 6f ff ff ff 	movzbl -0x91(%rbp),%edx
    154f:	0f b6 45 8f          	movzbl -0x71(%rbp),%eax
    1553:	38 c2                	cmp    %al,%dl
    1555:	74 0a                	je     1561 <rand@plt+0x441>
    1557:	bf 01 00 00 00       	mov    $0x1,%edi
    155c:	e8 af fb ff ff       	callq  1110 <exit@plt>
    1561:	0f b6 95 61 ff ff ff 	movzbl -0x9f(%rbp),%edx
    1568:	0f b6 45 81          	movzbl -0x7f(%rbp),%eax
    156c:	38 c2                	cmp    %al,%dl
    156e:	74 0a                	je     157a <rand@plt+0x45a>
    1570:	bf 01 00 00 00       	mov    $0x1,%edi
    1575:	e8 96 fb ff ff       	callq  1110 <exit@plt>
    157a:	0f b6 95 6c ff ff ff 	movzbl -0x94(%rbp),%edx
    1581:	0f b6 45 8c          	movzbl -0x74(%rbp),%eax
    1585:	38 c2                	cmp    %al,%dl
    1587:	74 0a                	je     1593 <rand@plt+0x473>
    1589:	bf 01 00 00 00       	mov    $0x1,%edi
    158e:	e8 7d fb ff ff       	callq  1110 <exit@plt>
    1593:	0f b6 95 73 ff ff ff 	movzbl -0x8d(%rbp),%edx
    159a:	0f b6 45 93          	movzbl -0x6d(%rbp),%eax
    159e:	38 c2                	cmp    %al,%dl
    15a0:	74 0a                	je     15ac <rand@plt+0x48c>
    15a2:	bf 01 00 00 00       	mov    $0x1,%edi
    15a7:	e8 64 fb ff ff       	callq  1110 <exit@plt>
    15ac:	0f b6 95 6d ff ff ff 	movzbl -0x93(%rbp),%edx
    15b3:	0f b6 45 8d          	movzbl -0x73(%rbp),%eax
    15b7:	38 c2                	cmp    %al,%dl
    15b9:	74 0a                	je     15c5 <rand@plt+0x4a5>
    15bb:	bf 01 00 00 00       	mov    $0x1,%edi
    15c0:	e8 4b fb ff ff       	callq  1110 <exit@plt>
    15c5:	0f b6 95 6e ff ff ff 	movzbl -0x92(%rbp),%edx
    15cc:	0f b6 45 8e          	movzbl -0x72(%rbp),%eax
    15d0:	38 c2                	cmp    %al,%dl
    15d2:	74 0a                	je     15de <rand@plt+0x4be>
    15d4:	bf 01 00 00 00       	mov    $0x1,%edi
    15d9:	e8 32 fb ff ff       	callq  1110 <exit@plt>
    15de:	0f b6 95 65 ff ff ff 	movzbl -0x9b(%rbp),%edx
    15e5:	0f b6 45 85          	movzbl -0x7b(%rbp),%eax
    15e9:	38 c2                	cmp    %al,%dl
    15eb:	74 0a                	je     15f7 <rand@plt+0x4d7>
    15ed:	bf 01 00 00 00       	mov    $0x1,%edi
    15f2:	e8 19 fb ff ff       	callq  1110 <exit@plt>
    15f7:	0f b6 95 69 ff ff ff 	movzbl -0x97(%rbp),%edx
    15fe:	0f b6 45 89          	movzbl -0x77(%rbp),%eax
    1602:	38 c2                	cmp    %al,%dl
    1604:	74 0a                	je     1610 <rand@plt+0x4f0>
    1606:	bf 01 00 00 00       	mov    $0x1,%edi
    160b:	e8 00 fb ff ff       	callq  1110 <exit@plt>
    1610:	0f b6 95 68 ff ff ff 	movzbl -0x98(%rbp),%edx
    1617:	0f b6 45 88          	movzbl -0x78(%rbp),%eax
    161b:	38 c2                	cmp    %al,%dl
    161d:	74 0a                	je     1629 <rand@plt+0x509>
    161f:	bf 01 00 00 00       	mov    $0x1,%edi
    1624:	e8 e7 fa ff ff       	callq  1110 <exit@plt>
    1629:	0f b6 95 72 ff ff ff 	movzbl -0x8e(%rbp),%edx
    1630:	0f b6 45 92          	movzbl -0x6e(%rbp),%eax
    1634:	38 c2                	cmp    %al,%dl
    1636:	74 0a                	je     1642 <rand@plt+0x522>
    1638:	bf 01 00 00 00       	mov    $0x1,%edi
    163d:	e8 ce fa ff ff       	callq  1110 <exit@plt>
    1642:	0f b6 95 66 ff ff ff 	movzbl -0x9a(%rbp),%edx
    1649:	0f b6 45 86          	movzbl -0x7a(%rbp),%eax
    164d:	38 c2                	cmp    %al,%dl
    164f:	74 0a                	je     165b <rand@plt+0x53b>
    1651:	bf 01 00 00 00       	mov    $0x1,%edi
    1656:	e8 b5 fa ff ff       	callq  1110 <exit@plt>
    165b:	0f b6 95 71 ff ff ff 	movzbl -0x8f(%rbp),%edx
    1662:	0f b6 45 91          	movzbl -0x6f(%rbp),%eax
    1666:	38 c2                	cmp    %al,%dl
    1668:	74 0a                	je     1674 <rand@plt+0x554>
    166a:	bf 01 00 00 00       	mov    $0x1,%edi
    166f:	e8 9c fa ff ff       	callq  1110 <exit@plt>
    1674:	0f b6 95 62 ff ff ff 	movzbl -0x9e(%rbp),%edx
    167b:	0f b6 45 82          	movzbl -0x7e(%rbp),%eax
    167f:	38 c2                	cmp    %al,%dl
    1681:	74 0a                	je     168d <rand@plt+0x56d>
    1683:	bf 01 00 00 00       	mov    $0x1,%edi
    1688:	e8 83 fa ff ff       	callq  1110 <exit@plt>
    168d:	0f b6 95 6a ff ff ff 	movzbl -0x96(%rbp),%edx
    1694:	0f b6 45 8a          	movzbl -0x76(%rbp),%eax
    1698:	38 c2                	cmp    %al,%dl
    169a:	74 0a                	je     16a6 <rand@plt+0x586>
    169c:	bf 01 00 00 00       	mov    $0x1,%edi
    16a1:	e8 6a fa ff ff       	callq  1110 <exit@plt>
    16a6:	0f b6 95 64 ff ff ff 	movzbl -0x9c(%rbp),%edx
    16ad:	0f b6 45 84          	movzbl -0x7c(%rbp),%eax
    16b1:	38 c2                	cmp    %al,%dl
    16b3:	74 0a                	je     16bf <rand@plt+0x59f>
    16b5:	bf 01 00 00 00       	mov    $0x1,%edi
    16ba:	e8 51 fa ff ff       	callq  1110 <exit@plt>
    16bf:	0f b6 45 c1          	movzbl -0x3f(%rbp),%eax
    16c3:	3c 3a                	cmp    $0x3a,%al
    16c5:	74 16                	je     16dd <rand@plt+0x5bd>
    16c7:	48 8d 3d ec 09 00 00 	lea    0x9ec(%rip),%rdi        # 20ba <rand@plt+0xf9a>
    16ce:	e8 8d f9 ff ff       	callq  1060 <puts@plt>
    16d3:	bf 01 00 00 00       	mov    $0x1,%edi
    16d8:	e8 33 fa ff ff       	callq  1110 <exit@plt>
    16dd:	c7 45 fc 00 00 00 00 	movl   $0x0,-0x4(%rbp)
    16e4:	c7 85 5c ff ff ff 65 	movl   $0x646e65,-0xa4(%rbp)
    16eb:	6e 64 00 
    16ee:	eb 2c                	jmp    171c <rand@plt+0x5fc>
    16f0:	8b 45 fc             	mov    -0x4(%rbp),%eax
    16f3:	48 98                	cltq   
    16f5:	0f b6 94 05 5c ff ff 	movzbl -0xa4(%rbp,%rax,1),%edx
    16fc:	ff 
    16fd:	8b 45 fc             	mov    -0x4(%rbp),%eax
    1700:	83 c0 22             	add    $0x22,%eax
    1703:	48 98                	cltq   
    1705:	0f b6 44 05 a0       	movzbl -0x60(%rbp,%rax,1),%eax
    170a:	38 c2                	cmp    %al,%dl
    170c:	74 0a                	je     1718 <rand@plt+0x5f8>
    170e:	bf 01 00 00 00       	mov    $0x1,%edi
    1713:	e8 f8 f9 ff ff       	callq  1110 <exit@plt>
    1718:	83 45 fc 01          	addl   $0x1,-0x4(%rbp)
    171c:	83 7d fc 02          	cmpl   $0x2,-0x4(%rbp)
    1720:	7e ce                	jle    16f0 <rand@plt+0x5d0>
    1722:	48 8d 3d 9e 09 00 00 	lea    0x99e(%rip),%rdi        # 20c7 <rand@plt+0xfa7>
    1729:	e8 32 f9 ff ff       	callq  1060 <puts@plt>
    172e:	e8 f6 fa ff ff       	callq  1229 <rand@plt+0x109>
    1733:	b8 00 00 00 00       	mov    $0x0,%eax
    1738:	c9                   	leaveq 
    1739:	c3                   	retq   
    173a:	55                   	push   %rbp
    173b:	48 89 e5             	mov    %rsp,%rbp
    173e:	53                   	push   %rbx
    173f:	48 89 7d f0          	mov    %rdi,-0x10(%rbp)
    1743:	48 89 75 e8          	mov    %rsi,-0x18(%rbp)
    1747:	48 89 55 e0          	mov    %rdx,-0x20(%rbp)
    174b:	48 89 4d d8          	mov    %rcx,-0x28(%rbp)
    174f:	48 8b 45 f0          	mov    -0x10(%rbp),%rax
    1753:	8b 08                	mov    (%rax),%ecx
    1755:	48 8b 45 e0          	mov    -0x20(%rbp),%rax
    1759:	8b 10                	mov    (%rax),%edx
    175b:	89 c8                	mov    %ecx,%eax
    175d:	89 d1                	mov    %edx,%ecx
    175f:	0f a2                	cpuid  
    1761:	89 de                	mov    %ebx,%esi
    1763:	48 8b 7d f0          	mov    -0x10(%rbp),%rdi
    1767:	89 07                	mov    %eax,(%rdi)
    1769:	48 8b 45 e8          	mov    -0x18(%rbp),%rax
    176d:	89 30                	mov    %esi,(%rax)
    176f:	48 8b 45 e0          	mov    -0x20(%rbp),%rax
    1773:	89 08                	mov    %ecx,(%rax)
    1775:	48 8b 45 d8          	mov    -0x28(%rbp),%rax
    1779:	89 10                	mov    %edx,(%rax)
    177b:	90                   	nop
    177c:	48 8b 5d f8          	mov    -0x8(%rbp),%rbx
    1780:	c9                   	leaveq 
    1781:	c3                   	retq   
    1782:	55                   	push   %rbp
    1783:	48 89 e5             	mov    %rsp,%rbp
    1786:	48 83 ec 20          	sub    $0x20,%rsp
    178a:	c7 45 fc 00 00 00 00 	movl   $0x0,-0x4(%rbp)
    1791:	c6 45 fb 00          	movb   $0x0,-0x5(%rbp)
    1795:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    1799:	48 8d 48 04          	lea    0x4(%rax),%rcx
    179d:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    17a1:	48 8d 50 08          	lea    0x8(%rax),%rdx
    17a5:	48 8d 75 ef          	lea    -0x11(%rbp),%rsi
    17a9:	48 8d 45 fc          	lea    -0x4(%rbp),%rax
    17ad:	48 89 c7             	mov    %rax,%rdi
    17b0:	e8 85 ff ff ff       	callq  173a <rand@plt+0x61a>
    17b5:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    17b9:	ba 0c 00 00 00       	mov    $0xc,%edx
    17be:	48 8d 35 1b 09 00 00 	lea    0x91b(%rip),%rsi        # 20e0 <rand@plt+0xfc0>
    17c5:	48 89 c7             	mov    %rax,%rdi
    17c8:	e8 73 f8 ff ff       	callq  1040 <strncmp@plt>
    17cd:	85 c0                	test   %eax,%eax
    17cf:	0f 84 8c 00 00 00    	je     1861 <rand@plt+0x741>
    17d5:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    17d9:	48 89 c2             	mov    %rax,%rdx
    17dc:	48 8d 05 0a 09 00 00 	lea    0x90a(%rip),%rax        # 20ed <rand@plt+0xfcd>
    17e3:	b9 0a 00 00 00       	mov    $0xa,%ecx
    17e8:	48 89 d6             	mov    %rdx,%rsi
    17eb:	48 89 c7             	mov    %rax,%rdi
    17ee:	f3 a6                	repz cmpsb %es:(%rdi),%ds:(%rsi)
    17f0:	0f 97 c0             	seta   %al
    17f3:	0f 92 c2             	setb   %dl
    17f6:	29 d0                	sub    %edx,%eax
    17f8:	0f be c0             	movsbl %al,%eax
    17fb:	85 c0                	test   %eax,%eax
    17fd:	74 62                	je     1861 <rand@plt+0x741>
    17ff:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    1803:	ba 0c 00 00 00       	mov    $0xc,%edx
    1808:	48 8d 35 e8 08 00 00 	lea    0x8e8(%rip),%rsi        # 20f7 <rand@plt+0xfd7>
    180f:	48 89 c7             	mov    %rax,%rdi
    1812:	e8 29 f8 ff ff       	callq  1040 <strncmp@plt>
    1817:	85 c0                	test   %eax,%eax
    1819:	74 46                	je     1861 <rand@plt+0x741>
    181b:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    181f:	ba 0c 00 00 00       	mov    $0xc,%edx
    1824:	48 8d 35 d9 08 00 00 	lea    0x8d9(%rip),%rsi        # 2104 <rand@plt+0xfe4>
    182b:	48 89 c7             	mov    %rax,%rdi
    182e:	e8 0d f8 ff ff       	callq  1040 <strncmp@plt>
    1833:	85 c0                	test   %eax,%eax
    1835:	74 2a                	je     1861 <rand@plt+0x741>
    1837:	48 8d 45 ef          	lea    -0x11(%rbp),%rax
    183b:	48 89 c2             	mov    %rax,%rdx
    183e:	48 8d 05 cc 08 00 00 	lea    0x8cc(%rip),%rax        # 2111 <rand@plt+0xff1>
    1845:	b9 0c 00 00 00       	mov    $0xc,%ecx
    184a:	48 89 d6             	mov    %rdx,%rsi
    184d:	48 89 c7             	mov    %rax,%rdi
    1850:	f3 a6                	repz cmpsb %es:(%rdi),%ds:(%rsi)
    1852:	0f 97 c0             	seta   %al
    1855:	0f 92 c2             	setb   %dl
    1858:	29 d0                	sub    %edx,%eax
    185a:	0f be c0             	movsbl %al,%eax
    185d:	85 c0                	test   %eax,%eax
    185f:	75 0a                	jne    186b <rand@plt+0x74b>
    1861:	bf 01 00 00 00       	mov    $0x1,%edi
    1866:	e8 a5 f8 ff ff       	callq  1110 <exit@plt>
    186b:	90                   	nop
    186c:	c9                   	leaveq 
    186d:	c3                   	retq   
    186e:	55                   	push   %rbp
    186f:	48 89 e5             	mov    %rsp,%rbp
    1872:	48 8d 3d a4 08 00 00 	lea    0x8a4(%rip),%rdi        # 211d <rand@plt+0xffd>
    1879:	e8 b2 f7 ff ff       	callq  1030 <getenv@plt>
    187e:	48 85 c0             	test   %rax,%rax
    1881:	74 0a                	je     188d <rand@plt+0x76d>
    1883:	bf 01 00 00 00       	mov    $0x1,%edi
    1888:	e8 83 f8 ff ff       	callq  1110 <exit@plt>
    188d:	be 00 00 00 00       	mov    $0x0,%esi
    1892:	48 8d 3d 8f 08 00 00 	lea    0x88f(%rip),%rdi        # 2128 <rand@plt+0x1008>
    1899:	b8 00 00 00 00       	mov    $0x0,%eax
    189e:	e8 4d f8 ff ff       	callq  10f0 <open@plt>
    18a3:	85 c0                	test   %eax,%eax
    18a5:	7e 0a                	jle    18b1 <rand@plt+0x791>
    18a7:	bf 01 00 00 00       	mov    $0x1,%edi
    18ac:	e8 5f f8 ff ff       	callq  1110 <exit@plt>
    18b1:	90                   	nop
    18b2:	5d                   	pop    %rbp
    18b3:	c3                   	retq   
    18b4:	55                   	push   %rbp
    18b5:	48 89 e5             	mov    %rsp,%rbp
    18b8:	b9 00 00 00 00       	mov    $0x0,%ecx
    18bd:	ba 01 00 00 00       	mov    $0x1,%edx
    18c2:	be 00 00 00 00       	mov    $0x0,%esi
    18c7:	bf 00 00 00 00       	mov    $0x0,%edi
    18cc:	b8 00 00 00 00       	mov    $0x0,%eax
    18d1:	e8 0a f8 ff ff       	callq  10e0 <ptrace@plt>
    18d6:	48 83 f8 ff          	cmp    $0xffffffffffffffff,%rax
    18da:	75 0a                	jne    18e6 <rand@plt+0x7c6>
    18dc:	bf 01 00 00 00       	mov    $0x1,%edi
    18e1:	e8 2a f8 ff ff       	callq  1110 <exit@plt>
    18e6:	90                   	nop
    18e7:	5d                   	pop    %rbp
    18e8:	c3                   	retq   
    18e9:	0f 1f 80 00 00 00 00 	nopl   0x0(%rax)
    18f0:	f3 0f 1e fa          	endbr64 
    18f4:	41 57                	push   %r15
    18f6:	4c 8d 3d db 24 00 00 	lea    0x24db(%rip),%r15        # 3dd8 <rand@plt+0x2cb8>
    18fd:	41 56                	push   %r14
    18ff:	49 89 d6             	mov    %rdx,%r14
    1902:	41 55                	push   %r13
    1904:	49 89 f5             	mov    %rsi,%r13
    1907:	41 54                	push   %r12
    1909:	41 89 fc             	mov    %edi,%r12d
    190c:	55                   	push   %rbp
    190d:	48 8d 2d cc 24 00 00 	lea    0x24cc(%rip),%rbp        # 3de0 <rand@plt+0x2cc0>
    1914:	53                   	push   %rbx
    1915:	4c 29 fd             	sub    %r15,%rbp
    1918:	48 83 ec 08          	sub    $0x8,%rsp
    191c:	e8 df f6 ff ff       	callq  1000 <getenv@plt-0x30>
    1921:	48 c1 fd 03          	sar    $0x3,%rbp
    1925:	74 1f                	je     1946 <rand@plt+0x826>
    1927:	31 db                	xor    %ebx,%ebx
    1929:	0f 1f 80 00 00 00 00 	nopl   0x0(%rax)
    1930:	4c 89 f2             	mov    %r14,%rdx
    1933:	4c 89 ee             	mov    %r13,%rsi
    1936:	44 89 e7             	mov    %r12d,%edi
    1939:	41 ff 14 df          	callq  *(%r15,%rbx,8)
    193d:	48 83 c3 01          	add    $0x1,%rbx
    1941:	48 39 dd             	cmp    %rbx,%rbp
    1944:	75 ea                	jne    1930 <rand@plt+0x810>
    1946:	48 83 c4 08          	add    $0x8,%rsp
    194a:	5b                   	pop    %rbx
    194b:	5d                   	pop    %rbp
    194c:	41 5c                	pop    %r12
    194e:	41 5d                	pop    %r13
    1950:	41 5e                	pop    %r14
    1952:	41 5f                	pop    %r15
    1954:	c3                   	retq   
    1955:	66 66 2e 0f 1f 84 00 	data16 nopw %cs:0x0(%rax,%rax,1)
    195c:	00 00 00 00 
    1960:	f3 0f 1e fa          	endbr64 
    1964:	c3                   	retq   
```
All the symbols have been removed which makes things harder. Let's look at the data segment.
```
Contents of section .rodata:
 2000 01000200 00000000 00000000 00000000  ................
 2010 00000000 00000000 00000000 00000000  ................
 2020 79656574 62616e6b 00706565 7062616e  yeetbank.peepban
 2030 6b006865 61706261 6e6b0073 6f667462  k.heapbank.softb
 2040 616e6b00 73656174 62616e6b 007a6f72  ank.seatbank.zor
 2050 7062616e 6b007200 666c6167 2e747874  pbank.r.flag.txt
 2060 00257300 00000000 57686174 27732079  .%s.....What's y
 2070 6f757220 63726564 69742063 61726420  our credit card 
 2080 6e756d62 65722028 666f7220 73616665  number (for safe
 2090 6b656570 696e6729 203f0a3e 3e200057  keeping) ?.>> .W
 20a0 656c6c20 74686973 20776173 20756e6e  ell this was unn
 20b0 65636573 73617279 2e004765 74206f75  ecessary..Get ou
 20c0 742e0025 6c640054 68616e6b 73210000  t..%ld.Thanks!..
 20d0 00000000 0000e03f 00000000 0000f03f  .......?.......?
 20e0 564d7761 7265564d 77617265 004b564d  VMwareVMware.KVM
 20f0 4b564d4b 564d0054 43475443 47544347  KVMKVM.TCGTCGTCG
 2100 54434700 4d696372 6f736f66 74204876  TCG.Microsoft Hv
 2110 00206c72 70657079 68207672 004c445f  . lrpepyh vr.LD_
 2120 5052454c 4f414400 2f657463 2f6c642e  PRELOAD./etc/ld.
 2130 736f2e70 72656c6f 616400             so.preload.    
```
We know that the initial message is located at `2068` so if we check back at the code and see when `2068` is referenced we can see that it is at `12cc`. Therefore the part of the code that we are interested in starts at `12bc`, the instruction after the most recent `retq`.

I translated the code into C. Here is the result:
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

long f(char c) {
    srand(c);
    return rand();
}

int f1229() {
    FILE *file = fopen("flag.txt", "r");
    char flag[264];
    fscanf(file, "%s", flag);
    puts(flag);
    fclose(file);
}

int main() {
    printf("What's your credit card number (for safekeeping) ?\n>> ");
    char buf[60]; // -0x60(%rbp)
    fgets(buf, 60, stdin);
    if (strlen(buf) > 60) {
        puts("Well this was unnecessary.");
        exit(1);
    }
    long x = 0; // -0x10(%rbp)
    x += 0x100;
    x >>= 4;
    Simd xmm2 = 0;
    xmm2 = (double) x; // lower half
    double rax = xmm2; // lower half
    Simd xmm0 = 0.5; // lower half
    Simd xmm1 = xmm0;
    xmm0 = rax;
    xmm0 = pow(xmm0, xmm1);
    rax = xmm0;
    xmm0 = 1.0;
    xmm1 = rax;
    xmm1 -= xmm0;
    int eax = xmm1;
    x = eax;
    char buf2[9]; // -0x20(%rbp)
    int i;
    for (i = 0; i < 8; i++) {
        buf2[i] = buf[i];
    }
    buf2[8] = '\0';
    eax = x;
    long rdx = eax;
    rax <<= 3;
    rdx += rax;
    char *bank = "yeetbank" + rdx;
    if (strncmp(buf2, bank, 8)) exit(1);
    if (buf[8] != ':') {
        puts("Get out.");
        exit(1);
    }
    char c8 = buf[9] - 0x30;
    char c14 = buf[10] - 0x30;
    char c18 = buf[11] - 0x30;
    if (buf[12] != ':') {
        puts("Get out.");
        exit(1);
    }
    char buf80[20];
    char str[10];
    for (i = 0; i < 20; i++) {
        snprintf(str, 10, "%ld", f(c8));
        buf80[i] = str[c18];
        c8 += c14;
    }
    char bufa0[20];
    for (i = 0; i < 20; i++) {
        bufa0[i] = buf[i + 13];
    }
    if (bufa0[0] != buf80[0]) exit(1);
    if (bufa0[16] != buf80[16]) exit(1);
    if (bufa0[11] != buf80[11]) exit(1);
    if (bufa0[3] != buf80[3]) exit(1);
    if (bufa0[7] != buf80[7]) exit(1);
    if (bufa0[15] != buf80[15]) exit(1);
    if (bufa0[1] != buf80[1]) exit(1);
    if (bufa0[12] != buf80[12]) exit(1);
    if (bufa0[19] != buf80[19]) exit(1);
    if (bufa0[13] != buf80[13]) exit(1);
    if (bufa0[14] != buf80[14]) exit(1);
    if (bufa0[5] != buf80[5]) exit(1);
    if (bufa0[9] != buf80[9]) exit(1);
    if (bufa0[8] != buf80[8]) exit(1);
    if (bufa0[18] != buf80[18]) exit(1);
    if (bufa0[6] != buf80[6]) exit(1);
    if (bufa0[17] != buf80[17]) exit(1);
    if (bufa0[2] != buf80[2]) exit(1);
    if (bufa0[10] != buf80[10]) exit(1);
    if (bufa0[4] != buf80[4]) exit(1);
    if (buf[33] != ':') {
        puts("Get out.");
        exit(1);
    }
    char *end = "end";
    for (i = 0; i < 3; i++) {
        if (buf[i + 34] != end[i]) exit(1);
    }
    puts("Thanks!");
    f1229();
    return 0;
}
```
This isn't fully valid C but it is enough to give us an idea of what is going on. Some parts of it I already simplified compared to the assembly in the process of writing it, but some parts are more low-level such as the simd part.

We can see that the code checks that the input meets certain conditions, and in the end, outputs the contents of flag.txt. The input is divided into 4 main parts. The first 8 characters must match some string. Then, the 9th character must be `:`. The 10th to 12th characters can be anything we want. The 13th character must be `:`. The 14th to 33rd characters must have a certain relation to the 10th to 12th characters. The 34th character must be `:`, and the 35th to 37th must be `end`.

First let us look at the first part. It seems like we need to match the input with some offset of the string starting at `"yeetbank"`. If we look in the data segement, we can see that after `yeetbank` there are a bunch of banks like `peepbank`, `heapbank`, etc. It could be any one of these. The offset we need is `rdx`, but if we look at the preceding code we can see that the value of `x` will always end up being `(long) (pow((0 + 0x100) >> 4, 0.5) - 1.0)`, which is `3`, and the value of `rdx` will be `(x << 3) + x` which is `27`. Therefore an offset of 27 means the string `softbank`, so the first 8 characters must be `softbank`.

The next section is input that we can control. The 3 characters in this section are converted from ascii digits to numbers by subtracting `0x30`. Let's call the 3 numbers *x*, *y*, and *z*. There is a loop with 20 iterations. Each iteration, the value of *x* is used as a seed to `srand`, then we get the value of `rand()` and format it into a 10-character string (including null terminator). We use *z* to index into the string and copy that character into a buffer. Then we increment *x* by *y*.

Now let's look at the section after that. It is 20 characters long. We compare each character to the corresponding one in the buffer in the last section, and all of them must match.

Let's see how to simplify this problem. We can set *y* to be 0 so that *x* remains the same every iteration. Then it seems like we still need to figure out how the internals of `srand` work so that we know what the output of `rand()` will be for the seed we provide. But notice that the string written by `snprintf` always contains a null terminator at the end. Therefore, we know that the 10th character will always be `'\0'`. So we can set *z* to 9. Now *x* doesn't matter, so it can be anything. So we just need to make the 20 characters in the next section all be `'\0'`. We can type it in the terminal by using `ctrl+@`. Therefore the input for these two sections can be `009` and `^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@`.

Finally, we already know that the final section must be `end`. So putting everything together, we have the input
```
softbank:009:^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@:end
```
I simplified the C file a bit and made it runnable. (The file is located at [not_malware.c](not_malware.c)). Then I tested the code by comparing it to the behavior of the actual `not_malware` binary and making sure that they were the same. The input seemed to work. Finally, I connected to the server with `nc` and put in the input and obtained the flag.
```
flag{th4x_f0r_ur_cr3d1t_c4rd}
```
