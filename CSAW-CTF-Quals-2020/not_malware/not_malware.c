#include <stdio.h>
#include <stdlib.h>
#include <string.h>

long f(char c) {
    srand(c);
    return rand();
}

int f1229() {
    FILE *file = fopen("flag.txt", "r");
    char flag[264];
    fscanf(file, "%s", flag);
    puts(flag);
    fclose(file);
}

int main() {
    printf("What's your credit card number (for safekeeping) ?\n>> ");
    char buf[60]; // -0x60(%rbp)
    fgets(buf, 60, stdin);
    if (strlen(buf) > 60) {
        puts("Well this was unnecessary.");
        exit(1);
    }
    // long x = 0; // -0x10(%rbp)
    // x += 0x100;
    // x >>= 4;
    // Simd xmm2 = 0;
    // xmm2 = (double) x; // lower half
    // double rax = xmm2; // lower half
    // Simd xmm0 = 0.5; // lower half
    // Simd xmm1 = xmm0;
    // xmm0 = rax;
    // xmm0 = pow(xmm0, xmm1); // pow(x, 0.5)
    // rax = xmm0;
    // xmm0 = 1.0;
    // xmm1 = rax;
    // xmm1 -= xmm0;
    // int eax = xmm1;
    // x = eax;
    long x = 3;
    char buf2[9]; // -0x20(%rbp)
    int i;
    for (i = 0; i < 8; i++) {
        buf2[i] = buf[i];
    }
    buf2[8] = '\0';
    // eax = x;
    // long rdx = eax;
    // rax <<= 3;
    // rdx += rax;
    // char *bank = "yeetbank" + rdx;
    char *bank = "softbank";
    if (strncmp(buf2, bank, 8)) exit(1);
    if (buf[8] != ':') {
        puts("Get out.");
        exit(1);
    }
    char c8 = buf[9] - 0x30;
    char c14 = buf[10] - 0x30;
    char c18 = buf[11] - 0x30;
    if (buf[12] != ':') {
        puts("Get out.");
        exit(1);
    }
    char buf80[20];
    char str[10];
    for (i = 0; i < 20; i++) {
        snprintf(str, 10, "%ld", f(c8));
        buf80[i] = str[c18];
        c8 += c14;
    }
    char bufa0[20];
    for (i = 0; i < 20; i++) {
        bufa0[i] = buf[i + 13];
    }
    if (bufa0[0] != buf80[0]) exit(1);
    if (bufa0[16] != buf80[16]) exit(1);
    if (bufa0[11] != buf80[11]) exit(1);
    if (bufa0[3] != buf80[3]) exit(1);
    if (bufa0[7] != buf80[7]) exit(1);
    if (bufa0[15] != buf80[15]) exit(1);
    if (bufa0[1] != buf80[1]) exit(1);
    if (bufa0[12] != buf80[12]) exit(1);
    if (bufa0[19] != buf80[19]) exit(1);
    if (bufa0[13] != buf80[13]) exit(1);
    if (bufa0[14] != buf80[14]) exit(1);
    if (bufa0[5] != buf80[5]) exit(1);
    if (bufa0[9] != buf80[9]) exit(1);
    if (bufa0[8] != buf80[8]) exit(1);
    if (bufa0[18] != buf80[18]) exit(1);
    if (bufa0[6] != buf80[6]) exit(1);
    if (bufa0[17] != buf80[17]) exit(1);
    if (bufa0[2] != buf80[2]) exit(1);
    if (bufa0[10] != buf80[10]) exit(1);
    if (bufa0[4] != buf80[4]) exit(1);
    if (buf[33] != ':') {
        puts("Get out.");
        exit(1);
    }
    char *end = "end";
    for (i = 0; i < 3; i++) {
        if (buf[i + 34] != end[i]) exit(1);
    }
    puts("Thanks!");
    f1229();
    return 0;
}
